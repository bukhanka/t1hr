Конечно. Учитывая проработанную модель данных, вот финальное, исчерпывающее описание интерфейса для роли "Сотрудник". Оно показывает, как именно пользователь взаимодействует с данными и как система мотивирует его на каждом шагу.

Роль: Сотрудник. Финальное описание

Философия интерфейса: Превратить корпоративную обязанность в личный инструмент управления карьерой. Каждое действие пользователя должно быть осмысленным, вознаграждаемым и немедленно демонстрировать свою пользу.

Доступы: Сотрудник видит и редактирует только свой профиль. Он может просматривать общую информацию о вакансиях, проектах и курсах, но не имеет доступа к личным профилям других сотрудников или к аналитическим инструментам HR и менеджеров.

Страница 1: "Мой Карьерный Путь" (Главный дашборд)

Это персонализированный командный центр. Он динамически меняется в зависимости от действий сотрудника и новых возможностей в компании.

Компоненты и фичи:

1. Компонент: Персональный ИИ-консультант "Навигатор"

Содержание: Проактивный виджет, который приветствует сотрудника по имени и инициирует диалог на основе последних событий. Пример: "Привет, Сергей! Я заметил, ты закрыл все задачи по проекту 'Альфа' в Jira. Отличная работа! Давай потратим 3 минуты, чтобы добавить твои достижения в профиль. Это принесет тебе +150 XP и сделает твой опыт видимым для всех проектных менеджеров".

Взаимодействие:

Диалог на естественном языке: Пользователь задает вопросы в свободной форме ("Какие курсы по Go сейчас доступны?", "Помоги составить план развития на полгода", "Сравни мой грейд с рынком").

Контекстные действия: Навигатор может предлагать кнопки-действия прямо в чате ("Добавить навык 'Docker' в профиль?", "Показать подходящие проекты?").

Связь с данными:

Читает: Все категории данных о сотруднике для максимальной персонализации. Особенно важны "Карьерные Амбиции" для советов и "Внутренний Опыт" для контекста.

Пишет: В "Системные данные" (история диалогов для самообучения), а также может инициировать запись в другие разделы (например, "Компетенции") с согласия пользователя.

2. Компонент: Виджет "Мой Прогресс"

Содержание: Интерактивный, геймифицированный блок, отображающий:

"Сила Профиля": Качественный показатель (0-100%), который зависит от полноты, детализации описаний проектов, наличия подтвержденных навыков и свежести данных.

Уровень и XP: Визуальная шкала опыта ("Уровень: Middle+. 450/1200 XP до 'Senior'").

Следующее лучшее действие: Умная подсказка, ведущая к самому ценному действию. Пример: "Заполни поле 'Ключевые результаты' для проекта 'Омега' и получи +100 XP".

Взаимодействие: При наведении мыши показывает, из чего складывается "Сила Профиля". Клик по подсказке переносит пользователя точно в нужное поле на странице "Мастерская Карьеры".

Связь с данными:

Читает: "Системные и Геймификационные данные" (XP, уровень). Алгоритм "Силы Профиля" анализирует все остальные категории данных на полноту и качество.

Не пишет, только визуализирует и обеспечивает навигацию.

3. Компонент: Лента "Рекомендованные Возможности"

Содержание: Персональная подборка карточек, сгенерированных ИИ на основе полного профиля сотрудника.

Карточка проекта: "Проект 'Феникс'". Почему подходит вам: Используется 'Kotlin', который вы указали в целях развития.

Карточка роли: "Роль 'Team Lead'". Почему подходит вам: Ваши подтвержденные навыки 'Менторство' и 'Управление командой' делают вас сильным кандидатом.

Взаимодействие: Сотрудник может сохранить возможность в "Избранное", скрыть ее (чтобы обучить алгоритм) или нажать "Узнать больше".

Связь с данными:

Читает: "Компетенции", "Внутренний Опыт", "Карьерные Амбиции". Сравнивает эти данные с базой внутренних проектов и вакансий.

Пишет: Реакции пользователя (скрыл/сохранил) записываются в "Системные данные" для улучшения будущих рекомендаций.

Страница 2: "Мастерская Карьеры" (Профиль)

Это не форма, а интерактивное пространство для "сборки" и "прокачки" своего профессионального аватара.

Компоненты и фичи:

1. Компонент: Первичный онбординг (при первом входе)

Содержание: Вместо пустого профиля, система встречает пользователя сообщением: "Добро пожаловать! Мы уже заполнили ваш профиль на основе данных из HR-отдела и вашего резюме. Давайте вместе проверим и дополним их. Это займет около 5 минут и сразу повысит вашу 'Силу Профиля' до 40%!"

Взаимодействие: Пошаговый "мастер", который проводит по ключевым разделам ("Компетенции", "Опыт"), предлагая подтвердить или уточнить импортированные данные и сразу начисляя первые XP.

Связь с данными:

Читает: Данные из "Базовые HR-данные" и "Профессиональный бэкграунд" (импортированные из резюме).

Пишет: Уточненные и подтвержденные пользователем данные в соответствующие категории.

2. Компонент: Редактор "Компетенции и Навыки"

Содержание: Интерактивный блок для управления навыками.

Взаимодействие:

Добавление навыка: Умный ввод с автодополнением из корпоративного словаря.

Самооценка: Простая шкала уровня владения.

Подтверждение: Кнопка "Запросить подтверждение" рядом с навыком, позволяющая выбрать коллег, которые могут верифицировать этот навык.

Цели развития: Переключатель "Использую / Хочу изучить" у каждого навыка.

Связь с данными: Основной интерфейс для записи и редактирования данных в категории "Компетенции и Навыки".

3. Компонент: "Портфолио Проектов и Достижений"

Содержание: Список проектов. Проекты, импортированные из Jira, имеют пометку "Требует дополнения".

Взаимодействие: Пользователь кликает на проект и в удобной форме заполняет поля: "Моя роль", "Использованные навыки" (выбор из уже добавленных компетенций) и ключевое поле — "Мои достижения и результаты" (с примерами-подсказками).

Связь с данными:

Читает: Базовую информацию о проектах из интегрированных систем (Jira).

Пишет: Обогащенные, качественные данные (роль, достижения) в категорию "Внутренний Опыт и Достижения". Это одно из самых высокооплачиваемых в XP действий.

4. Компонент: "Мои Карьерные Цели"

Содержание: Небольшой, но стратегически важный блок.

Взаимодействие: Вместо пустых полей — структурированный выбор из списков: "Целевая должность", "Интересующее направление/отдел", "Желаемый вектор" (экспертный, менеджерский).

Связь с данными: Напрямую записывает данные в категорию "Карьерные Амбиции и Развитие". Эта информация является одной из самых ценных для ИИ-Навигатора.

5. Компонент: "Зал Славы"

Содержание: Визуально привлекательная страница со всеми заработанными бейджами ("Мастер Профиля", "Сертифицированный специалист", "Ментор года"), текущим уровнем и статистикой.

Взаимодействие: Пользователь может просматривать свои достижения. Возможность поделиться бейджем во внутренней соцсети.

Связь с данными: Только читает и красиво визуализирует "Системные и Геймификационные данные".

Разумеется. Основываясь на нашем определении Проектного Менеджера как тактика, которому нужна скорость и точность, вот финальное описание его роли, интерфейсов и взаимодействия с данными.

Роль: Проектный/Ресурсный Менеджер. Финальное описание

Философия интерфейса: "Командный мостик" для управления ресурсами. Инструмент должен быть предельно функциональным, быстрым и ориентированным на результат. Цель — сократить путь от "у меня есть потребность" до "у меня есть шорт-лист идеальных кандидатов" с нескольких дней до нескольких минут.

Доступы: Менеджер имеет доступ на чтение к профессиональным профилям сотрудников. Он видит их компетенции, опыт, проекты и достижения. Он не видит конфиденциальную информацию, такую как "Карьерные амбиции" сотрудника (чтобы избежать предвзятости), точные данные о прохождении курсов или детали диалогов с ИИ-Навигатором. Он не может редактировать чужие профили.

Страница 1: "Центр Поиска Талантов" (Talent Discovery Hub)

Это основная и, по сути, единственная рабочая область менеджера. Она спроектирована для максимальной эффективности и минимизации кликов.

Компоненты и фичи:

1. Компонент: Умная Поисковая Строка (Smart Search Bar)

Содержание: Центральный, доминирующий элемент интерфейса. Это не просто поле, а интеллектуальный ассистент по поиску.

Взаимодействие:

Поиск на естественном языке: Менеджер вводит запрос так, как поставил бы задачу ассистенту: "Мне нужен Senior Java разработчик с опытом в финтехе, который работал с Kafka и знает микросервисы. Важно, чтобы он был доступен в следующем месяце". LLM-модель на лету преобразует это в набор фильтров.

Продвинутые фильтры: Для более точного поиска менеджер может открыть панель с фильтрами по конкретным навыкам, проектам, грейдам, отделам и предполагаемой доступности.

Связь с данными:

Читает: Все профессиональные данные сотрудников: "Компетенции" (включая уровень и подтверждения), "Внутренний опыт" (особенно названия проектов и описания результатов), "Базовые HR-данные" (грейд, отдел).

2. Компонент: Панель Результатов (Results Panel)

Содержание: Динамически обновляемый список кандидатов, представленных в виде информативных "карточек". Каждая карточка содержит:

Фото, ФИО, должность.

"Match Score" (Процент соответствия): Ключевой показатель, рассчитанный ИИ, показывающий, насколько профиль кандидата соответствует запросу.

Ключевые совпадения: Теги навыков или проектов, которые напрямую совпали с запросом.

Статус доступности (если возможно): Индикатор текущей загрузки (например, "На критическом проекте до 01.12", "Доступен для новых задач").

Взаимодействие:

Сортировка по релевантности, имени, грейду.

Клик на карточку открывает детальный профиль сотрудника в режиме просмотра.

Кнопка на карточке "Добавить в шорт-лист" для быстрого отбора кандидатов.

Связь с данными:

Читает: Данные из профилей сотрудников для отображения на карточках. Match Score — это расчетный показатель, который генерируется системой в реальном времени.

3. Компонент: Детальный Профиль Сотрудника (Read-Only View)

Содержание: При клике на карточку открывается полная, но профессионально-ориентированная версия профиля. Акцент сделан на данных, важных для принятия решения:

Компетенции: Список навыков с указанием уровня владения и, что важно, иконками подтверждения от коллег.

Портфолио Проектов: Детальное описание участия во внутренних проектах. Особо выделяется блок "Ключевые результаты и достижения".

Базовые данные: Грейд, стаж в компании, отдел, руководитель.

Взаимодействие: Только просмотр. Нет возможности комментировать или редактировать. Есть кнопка "Связаться" (открывает корпоративный мессенджер) или "Добавить в шорт-лист".

Связь с данными:

Читает: Все разрешенные для просмотра данные из профиля сотрудника.

Страница 2: "Конструктор Команды / Шорт-листы"

Это личное рабочее пространство менеджера для организации найденных талантов. Сюда можно попасть, кликнув на иконку "Мои шорт-листы".

Компоненты и фичи:

1. Компонент: Рабочая Область Проекта (Project Workspace)

Содержание: Менеджер может создавать папки или доски для разных проектов или ролей (например, "Проект Феникс: Backend", "Проект Феникс: QA").

Взаимодействие:

Перетаскивание карточек кандидатов из результатов поиска прямо в эти списки.

Возможность добавлять личные, приватные заметки к каждому кандидату в шорт-листе ("Идеальный кандидат, но нужно поговорить с его текущим руководителем").

Связь с данными:

Пишет: Создает и сохраняет сущности "Шорт-лист" и "Заметки", которые привязаны к профилю менеджера и недоступны никому другому. Эти данные хранятся отдельно от профилей сотрудников.

2. Компонент: Аналитика Собранной Команды (Team Analytics)

Содержание: Мощный инструмент визуализации. Как только менеджер собрал в шорт-листе потенциальную команду, он может нажать кнопку "Анализ" и увидеть:

Матрицу компетенций: Таблица, где по одной оси — члены команды, по другой — требуемые для проекта навыки. Сразу видно, какие компетенции покрыты, а где есть пробелы.

Общую стоимость команды (оценочно): На основе грейдов система может показать примерный уровень затрат на команду.

"Карту Синергии": Визуализация того, работали ли эти люди раньше вместе на проектах (на основе данных из их профилей).

Взаимодействие: Интерактивные графики, которые помогают принять финальное решение о составе команды.

Связь с данными:

Читает: Данные из профилей всех сотрудников, добавленных в шорт-лист, и агрегирует их для построения визуализаций. Это временный, расчетный анализ, который не сохраняется.

Абсолютно. Переходим к роли стратега — HR-специалиста. Его интерфейс должен быть аналитическим, наглядным и ориентированным на работу с большими данными, а не с отдельными личностями.

Роль: HR-специалист. Финальное описание

Философия интерфейса: "Стратегическая карта талантов". HR-специалист должен видеть не деревья, а лес. Его инструменты — это не лупа для изучения одного профиля, а спутник для обзора всей кадровой ситуации в компании. Интерфейс должен помогать находить инсайты, выявлять тренды и принимать решения, основанные на данных.

Доступы: HR-специалист имеет самый широкий, но агрегированный и анонимизированный доступ к данным. Он может видеть статистику по всей компании, строить отчеты по отделам и грейдам. Он может получить доступ к отдельным профилям (в том же read-only режиме, что и менеджер), но его основной сценарий не предполагает этого. В отличие от менеджера, HR может видеть обезличенную статистику по "Карьерным Амбициям" ("30% Junior-разработчиков хотят перейти в DevOps"), так как это критически важно для стратегического планирования.

Страница 1: "Панель HR-Аналитики" (HR Analytics Dashboard)

Это главный экран и основной рабочий инструмент HR. Он представляет собой набор интерактивных виджетов и графиков, отражающих кадровое здоровье компании в реальном времени.

Компоненты и фичи:

1. Компонент: Ключевые HR-метрики (Live Metrics)

Содержание: Верхняя панель с самыми важными показателями:

Общее "Здоровье Профилей": Средний показатель "Силы Профиля" по компании. Тренд: +5% за последний месяц.

Уровень вовлеченности: % сотрудников, заходивших в систему за последние 30 дней.

"Тепловая Карта Компетенций": Визуальное отображение самых популярных и самых редких (и, возможно, самых ценных) навыков в компании.

Индекс кадрового риска: % сотрудников, чьи профили не обновлялись более 6 месяцев или чьи навыки устаревают.

Взаимодействие: Клик по любой метрике ведет к более детальному отчету. Например, клик на "Тепловую Карту" открывает страницу "Анализ Компетенций".

Связь с данными:

Читает: Агрегированные данные из всех категорий профилей сотрудников. Расчеты производятся на лету или фоново.

2. Компонент: "Анализ Разрывов в Компетенциях" (Skills Gap Analysis)

Содержание: Интерактивный виджет, где HR может:

Выбрать должность (например, "Senior Data Scientist").

Система автоматически строит "эталонный профиль" (на основе данных от лучших сотрудников на этой должности) и сравнивает его с профилем "среднего" сотрудника (например, "Middle Data Scientist").

Результат — наглядный график, показывающий, каких именно навыков не хватает для перехода на следующий уровень. Инсайт: "Нашим Middle DS не хватает навыков 'MLOps' и 'Airflow' для роста".

Взаимодействие: Выбор ролей, фильтрация по отделам. Возможность экспортировать отчет.

Связь с данными:

Читает: Глубоко анализирует категорию "Компетенции и Навыки", сопоставляя ее с "Базовыми HR-данными" (должности, грейды).

3. Компонент: "Карьерные Ожидания Сотрудников"

Содержание: Анонимизированный дашборд, который показывает, куда хотят расти сотрудники.

Диаграмма: "Топ-5 самых желанных должностей для перехода".

Облако тегов: "Самые востребованные для изучения навыки".

График: "Динамика интереса к горизонтальным и вертикальным переходам".

Взаимодействие: Фильтрация по грейдам и департаментам ("Куда хотят расти наши джуниоры в IT-отделе?").

Связь с данными:

Читает: Единственная роль, которая имеет доступ к агрегированным и обезличенным данным из категории "Карьерные Амбиции и Развитие".

Страница 2: "Конструктор Отчетов"

Это продвинутый инструмент для HR, позволяющий создавать кастомные отчеты и глубоко исследовать кадровые данные.

Компоненты и фичи:

1. Компонент: Модуль "Сегментация Аудитории"

Содержание: Интерфейс, похожий на продвинутые фильтры, но работающий с более сложными логическими условиями.

Взаимодействие: HR может построить сегмент по запросу:

Найти всех сотрудников (сегмент "Высокий потенциал"), которые:

Имеют грейд Middle+.

И "Силу Профиля" > 90%.

И имеют подтвержденный навык "Менторство".

И указали в целях "Вертикальный рост".

Результатом будет список сотрудников, который можно выгрузить или использовать для создания программы "Кадровый резерв".

Связь с данными: Мощный инструмент, который может читать и комбинировать данные из всех категорий профилей для построения выборок.

2. Компонент: "Управление Талантами и Преемственностью" (Talent & Succession)

Содержание: Специализированный интерфейс для ведения кадрового резерва на ключевые позиции.

Взаимодействие:

HR выбирает ключевую должность (например, "Руководитель отдела разработки").

Система, используя данные из "Сегментации", предлагает наиболее подходящих внутренних кандидатов.

HR может отметить этих кандидатов как "преемников", добавить приватные заметки и отслеживать их прогресс (например, назначить им рекомендованные курсы).

Связь с данными:

Читает: Профили сотрудников для поиска кандидатов.

Пишет: Создает и хранит отдельные сущности "План преемственности" и "Кадровый резерв", которые видны только HR-департаменту.

3. Компонент: "Аналитика Вовлеченности"

Содержание: Отчет, который показывает, как разные отделы и группы сотрудников взаимодействуют с платформой.

Взаимодействие:

Графики: Динамика заполнения профилей по департаментам.

Топ-листы: Самые активные сотрудники (лидеры мнений), самые популярные курсы.

Инсайты: Например, "В отделе маркетинга резко упала активность после смены руководителя. Стоит обратить внимание".

Связь с данными:

Читает: Агрегированные "Системные и Геймификационные данные" и сопоставляет их с "Базовыми HR-данными".

Таким образом, HR-специалист получает мощный стратегический инструмент, который позволяет ему перейти от реактивного решения кадровых проблем к проактивному управлению талантами, опираясь на полную и актуальную картину происходящего в компании.

Отлично, переходим к технической реализации. Выбранный вами стек — Next.js, Prisma, PostgreSQL, Tailwind — идеален для такого проекта. Он современный, производительный и позволяет быстро разрабатывать как фронтенд, так и бэкенд.

Референс интерфейса хороший: чистый, корпоративный, не перегруженный. Мы можем взять его за основу, но сделать компоненты более интерактивными и "живыми", как мы обсуждали.

Давайте спроектируем полную техническую архитектуру, схему данных и ключевые моменты реализации, включая интеграцию с SciBox.

1. Общий Технологический Стек

Фреймворк: Next.js (App Router). Позволяет нам иметь и клиентские компоненты (UI), и серверные (для выборки данных), и API-роуты для бэкенд-логики в одном проекте.

ORM и База Данных: Prisma + PostgreSQL. Prisma дает нам строгую типизацию и удобный API для работы с БД. PostgreSQL — мощная и надежная реляционная СУБД.

Важное расширение: Нам понадобится расширение pgvector для PostgreSQL для хранения и эффективного поиска по векторным эмбеддингам, которые мы будем получать от модели bge-m3.

Стилизация: Tailwind CSS. Утилитарный подход для быстрой и кастомной верстки.

UI-компоненты: Shadcn/UI или Headless UI. Это не библиотеки в классическом виде, а наборы готовых, кастомизируемых и доступных компонентов, которые отлично работают с Tailwind. Позволят не тратить время на создание модальных окон, выпадающих списков и т.д.

Аутентификация: NextAuth.js (Auth.js). Стандарт де-факто для Next.js, легко интегрируется с корпоративными провайдерами (если понадобится в будущем).

LLM-взаимодействие: OpenAI Python/JS client (как указано в инструкции) для удобной работы с OpenAI-совместимым API от SciBox.

2. Архитектура Системы

Архитектура будет состоять из трех основных слоев:

Клиент (Frontend): React-компоненты в Next.js, которые рендерятся на сервере или клиенте. Отвечают за отображение UI и взаимодействие с пользователем.

Бэкенд (Backend): API-роуты в Next.js (/app/api/...). Здесь будет вся бизнес-логика: работа с Prisma, обработка запросов, геймификация и, что критически важно, все вызовы к внешнему SciBox API. Ключ API никогда не должен попадать на клиент.

База данных (Database): Экземпляр PostgreSQL, которым управляет Prisma.

Схема взаимодействия:

3. Схема Базы Данных (Prisma Schema)

Это сердце нашей системы. Схема schema.prisma будет выглядеть примерно так:

code
Prisma
download
content_copy
expand_less

// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Модель пользователя, в основном для аутентификации и ролей
model User {
  id        String    @id @default(cuid())
  email     String    @unique
  name      String?
  role      Role      @default(EMPLOYEE)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  // Связь с профилем 1-к-1
  profile   Profile?
}

// Перечисление ролей в системе
enum Role {
  EMPLOYEE
  MANAGER
  HR
}

// Основная модель с данными, которые сотрудник может редактировать
model Profile {
  id              String      @id @default(cuid())
  userId          String      @unique
  user            User        @relation(fields: [userId], references: [id])

  // Базовые HR-данные (могут синхронизироваться)
  jobTitle        String?     // Должность
  department      String?     // Отдел
  reportsToId     String?     // ID руководителя

  // Геймификация
  xp              Int         @default(0)
  level           Int         @default(1)
  profileStrength Int         @default(0) // "Сила профиля" от 0 до 100

  // Вектор для семантического поиска. Требует расширения pgvector
  // Размерность (1024) нужно уточнить у модели bge-m3
  embedding       Unsupported("vector(1024)")?

  // Связи с другими моделями
  userSkills      UserSkill[]
  userProjects    UserProject[]
  careerGoals     CareerGoal[]
  badges          UserBadge[]
}

// Справочник всех навыков в компании
model Skill {
  id          String      @id @default(cuid())
  name        String      @unique
  description String?

  // Связь
  userSkills  UserSkill[]
}

// Связующая таблица: какой пользователь каким навыком обладает
model UserSkill {
  id          String   @id @default(cuid())
  profileId   String
  skillId     String
  level       Int      // Самооценка от 1 до 5
  isVerified  Boolean  @default(false)
  status      SkillStatus @default(USING)

  profile     Profile  @relation(fields: [profileId], references: [id])
  skill       Skill    @relation(fields: [skillId], references: [id])

  @@unique([profileId, skillId]) // У одного юзера не может быть двух одинаковых навыков
}

enum SkillStatus {
  USING
  WANTS_TO_LEARN
}

// Справочник всех проектов
model Project {
  id           String        @id @default(cuid())
  name         String
  description  String?
  
  userProjects UserProject[]
}

// Связующая таблица: кто в каком проекте участвовал
model UserProject {
  id           String  @id @default(cuid())
  profileId    String
  projectId    String
  roleInProject String // Роль на проекте
  achievements String  // "Мои ключевые результаты" - самое важное поле!

  profile      Profile @relation(fields: [profileId], references: [id])
  project      Project @relation(fields: [projectId], references: [id])
}

// Справочник всех возможных бейджей
model Badge {
  id           String      @id @default(cuid())
  name         String      @unique
  description  String
  iconUrl      String

  awardedUsers UserBadge[]
}

// Связующая таблица: какие бейджи выданы пользователям
model UserBadge {
  id        String   @id @default(cuid())
  profileId String
  badgeId   String
  awardedAt DateTime @default(now())

  profile   Profile  @relation(fields: [profileId], references: [id])
  badge     Badge    @relation(fields: [badgeId], references: [id])
}

// Карьерные цели сотрудника
model CareerGoal {
  id        String   @id @default(cuid())
  profileId String
  // Например, "Вертикальный рост", "Горизонтальный переход"
  goalType  String
  // Например, "Senior Developer", "Data Science"
  target    String

  profile   Profile  @relation(fields: [profileId], references: [id])
}```

---

### 4. Ключевые Технические Решения (Как работают фичи)

#### **а) ИИ-Консультант ("Навигатор")**

1.  **Frontend:** Создаем чат-компонент (например, `AIChatWindow.tsx`). При отправке сообщения он делает POST-запрос на наш бэкенд: `/api/ai/chat`.
2.  **Backend (`/api/ai/chat`):**
    *   Получает `message` от пользователя.
    *   Извлекает из БД по `userId` всю необходимую информацию: навыки, проекты, цели.
    *   **Формирует системный промпт (System Prompt):** Это самый важный шаг. Промпт "настраивает" LLM на нужную роль.
        ```
        Ты - 'Навигатор', внутренний карьерный ИИ-консультант в компании Т1. Твоя задача - помогать сотрудникам развиваться внутри компании.
        Ты дружелюбен, но профессионален. Ты всегда основываешь свои ответы на предоставленных данных о сотруднике.
        Не выдумывай внешние курсы или несуществующие должности. Предлагай только внутренние возможности.

        Вот данные о сотруднике, с которым ты общаешься:
        - Должность: {profile.jobTitle}
        - Навыки (уровень): {profile.userSkills.map(s => `${s.skill.name} (${s.level}/5)`).join(', ')}
        - Навыки к изучению: {profile.userSkills.filter(s => s.status === 'WANTS_TO_LEARN')...}
        - Карьерные цели: {profile.careerGoals.map(g => `${g.goalType}: ${g.target}`).join('; ')}
        - Проекты: {profile.userProjects.map(p => p.project.name).join(', ')}
        ```
    *   Создает `messages` массив (системный промпт + история диалога + новое сообщение пользователя).
    *   Используя `openai` клиент, настроенный на URL SciBox, делает запрос к модели `Qwen2.5-72B-Instruct-AWQ` с параметром `stream: true`.
    *   Возвращает потоковый ответ (Streaming Response) на клиент, что обеспечивает эффект "печатающегося" текста.

#### **б) Умный Поиск для Менеджера (с использованием эмбеддингов)**

Это двухэтапный процесс: **Индексация** и **Поиск**.

1.  **Индексация (фоновый процесс):**
    *   Создаем API-роут, например, `/api/profile/update-embedding`.
    *   Каждый раз, когда сотрудник значительно обновляет свой профиль (добавляет проект, навыки), этот роут вызывается.
    *   **Логика роута:**
        *   Собирает все ключевые текстовые данные профиля в одну большую строку-документ: "Сотрудник: Иван Иванов. Должность: Backend Developer. Навыки: Java (5/5), Spring, PostgreSQL (4/5). Участвовал в проекте 'Омега', где увеличил скорость обработки платежей на 20%...".
        *   Отправляет эту строку в SciBox на эндпоинт `/v1/embeddings` с моделью `bge-m3`.
        *   Получает в ответ вектор (массив чисел), например, размером 1024.
        *   С помощью Prisma сохраняет этот вектор в поле `embedding` в таблице `Profile` пользователя: `prisma.profile.update({ where: { userId }, data: { embedding: vector } })`.

2.  **Поиск (когда менеджер вводит запрос):**
    *   **Frontend:** Менеджер вводит в поисковую строку "ищу питон-аналитика для телеком проекта". Запрос улетает на `/api/search`.
    *   **Backend (`/api/search`):**
        *   Берет поисковую фразу менеджера.
        *   Отправляет ее на тот же эндпоинт `/v1/embeddings` с моделью `bge-m3`, чтобы получить **вектор запроса**.
        *   Выполняет в PostgreSQL (через Prisma) **векторный поиск**. Prisma имеет preview-поддержку `pgvector`. Запрос будет выглядеть примерно так, чтобы найти 5 самых похожих профилей:
          ```typescript
          const results = await prisma.$queryRaw`
            SELECT "profileId", 1 - (embedding <=> ${queryVector}) as similarity
            FROM "Profile"
            ORDER BY similarity DESC
            LIMIT 5;
          `;
          ```
        *   Получает ID самых релевантных профилей, подтягивает их полные данные и отдает на фронтенд для отображения.

Этот подход намного мощнее простого поиска по ключевым словам, так как он понимает семантическую близость (например, "разработчик" и "программист" для него будут близки).

#### **в) Геймификация**

Логика геймификации реализуется на бэкенде. Можно создать отдельный сервис `GamificationService`.

*   **Пример:** Пользователь добавляет описание достижений в проект.
*   Контроллер API `/api/projects/update` после успешного сохранения данных вызывает `GamificationService.awardXP(userId, 'PROJECT_ACHIEVEMENT_ADDED')`.
*   Сервис смотрит, сколько XP дать за это действие, обновляет поле `xp` в `Profile`.
*   Затем он проверяет, не пересек ли пользователь порог для нового уровня или получения бейджа ("Архивариус" за 5 описанных проектов). Если да — обновляет `level` и создает запись в `UserBadge`.
*   На фронтенде появляются уведомления о получении награды.