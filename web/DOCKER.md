# Docker Setup –¥–ª—è SciBox Talent Management System

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### üêß Linux / macOS (—Å Make)

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
cp env.example .env.local
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ SCIBOX_API_KEY –≤ .env.local
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é —Å—Ä–µ–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```bash
make setup  # –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç –ë–î
make dev-up # –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏
```

### ü™ü Windows (CMD)

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```cmd
copy env.example .env.local
REM –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ SCIBOX_API_KEY –≤ .env.local
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é —Å—Ä–µ–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```cmd
scripts.bat setup   REM –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
scripts.bat dev-up  REM –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏
```

### ü™ü Windows (PowerShell)

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```powershell
Copy-Item env.example .env.local
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ SCIBOX_API_KEY –≤ .env.local
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é —Å—Ä–µ–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```powershell
.\scripts.ps1 setup   # –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
.\scripts.ps1 dev-up  # –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏
```

### üåê –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± (Docker Compose –Ω–∞–ø—Ä—è–º—É—é)

–ï—Å–ª–∏ Make/—Å–∫—Ä–∏–ø—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã:
```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (—Å–º. –≤—ã—à–µ)
# 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# 3. –ó–∞–ø—É—Å–∫ –ë–î
docker compose up -d postgres redis  # –∏–ª–∏ docker-compose

# 4. –ú–∏–≥—Ä–∞—Ü–∏–∏
npx prisma migrate dev --name init
npx prisma generate

# 5. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker compose -f docker-compose.yml -f docker-compose.dev.yml up -d
```

**–î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é:** http://localhost:3000

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

1. **–°–æ–±–µ—Ä–∏—Ç–µ production –æ–±—Ä–∞–∑:**
```bash
make prod-build
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ production —Å—Ä–µ–¥—É:**
```bash
make prod-up
```

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### üêß Linux/macOS (Make)
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `make setup` | –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ |
| `make dev-up` | –ó–∞–ø—É—Å–∫ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| `make dev-down` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| `make db-up` | –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `make db-down` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `make logs` | –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| `make clean` | –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Ç–æ–º–æ–≤ |

### ü™ü Windows (CMD)
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `scripts.bat setup` | –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ |
| `scripts.bat dev-up` | –ó–∞–ø—É—Å–∫ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| `scripts.bat dev-down` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| `scripts.bat db-up` | –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `scripts.bat db-down` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `scripts.bat logs` | –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| `scripts.bat clean` | –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Ç–æ–º–æ–≤ |

### ü™ü Windows (PowerShell)
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `.\scripts.ps1 setup` | –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ |
| `.\scripts.ps1 dev-up` | –ó–∞–ø—É—Å–∫ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| `.\scripts.ps1 dev-down` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| `.\scripts.ps1 db-up` | –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `.\scripts.ps1 db-down` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `.\scripts.ps1 logs` | –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| `.\scripts.ps1 clean` | –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Ç–æ–º–æ–≤ |

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
–ó–∞–ø—É—Å—Ç–∏—Ç–µ `make help` (–∏–ª–∏ `make` –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤) —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å:
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –û–°
- –í–µ—Ä—Å–∏—é Docker Compose (`docker compose` vs `docker-compose`)
- –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

## üê≥ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### Development (docker-compose.dev.yml)
- **app** - Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ dev —Ä–µ–∂–∏–º–µ —Å hot reload
- **postgres** - PostgreSQL 16 —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º pgvector
- **redis** - Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

### Production (docker-compose.yml)
- **postgres** - PostgreSQL —Å pgvector
- **redis** - Redis
- **app** (–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ prod-up) - Next.js –≤ production —Ä–µ–∂–∏–º–µ

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### PostgreSQL
- **–í–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç:** 5433 (—á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω—ã–º PostgreSQL)
- **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç:** 5432
- **–ë–∞–∑–∞:** scibox_talent_db
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** postgres
- **–ü–∞—Ä–æ–ª—å:** password
- **–†–∞—Å—à–∏—Ä–µ–Ω–∏—è:** pgvector –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

### Redis
- **–ü–æ—Ä—Ç:** 6379
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–µ—Å—Å–∏–∏ (–≤ –±—É–¥—É—â–µ–º)

### Next.js App
- **–ü–æ—Ä—Ç:** 3000
- **–†–µ–∂–∏–º—ã:** development (hot reload) / production (optimized)

## üìù –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env.local` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example`:

```env
# Database (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –¥–ª—è Docker)
DATABASE_URL="postgresql://postgres:password@postgres:5432/scibox_talent_db?schema=public"

# SciBox API (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –∫–ª—é—á)
SCIBOX_API_KEY="your-real-api-key-here"
SCIBOX_API_BASE_URL="https://llm.t1v.scibox.tech/v1"

# NextAuth
NEXTAUTH_SECRET="your-secret-key"
NEXTAUTH_URL="http://localhost:3000"
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏
```bash
make logs        # –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make logs-db     # –õ–æ–≥–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```

### –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º
```bash
docker exec -it scibox-talent-app sh     # Next.js –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker exec -it scibox-talent-db psql -U postgres scibox_talent_db  # PostgreSQL
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
```bash
docker compose ps  # –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–∏–ª–∏ docker-compose ps)
```

### –†–µ—à–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

#### ‚ùå "Port already in use" (–ü–æ—Ä—Ç –∑–∞–Ω—è—Ç)
–ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL –Ω–∞ –ø–æ—Ä—Ç—É 5432:
- Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç **5433** –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º 5432
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env.local` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç: `localhost:5433`

#### ‚ùå "docker-compose command not found"
–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Makefile –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É:
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Docker: `docker compose`
- –°—Ç–∞—Ä—ã–π Docker Compose: `docker-compose`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `make help` –ø–æ–∫–∞–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –∫–æ–º–∞–Ω–¥—É

#### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ (Linux/macOS)
```bash
sudo chown -R $USER:$USER .
```

## üõ†Ô∏è –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

- `Dockerfile` - Production –æ–±—Ä–∞–∑ Next.js
- `Dockerfile.dev` - Development –æ–±—Ä–∞–∑ Next.js
- `docker-compose.yml` - –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (–ë–î + Redis)
- `docker-compose.dev.yml` - –î–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `scripts/init-db.sql` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PostgreSQL —Å pgvector
- `.dockerignore` - –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–æ–≤
- `Makefile` - –£–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ health checks:
- PostgreSQL: –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∏ –ø—Ä–∏ —Å–±–æ—è—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üîÑ Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. `make setup` (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Ä–∞–∑)
2. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å `make dev-up`
3. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è
4. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å `make dev-down`
5. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å `make clean`
